[50.52647742, 18.10054304], [50.52647217, 18.10055123],
      [50.52646453, 18.10055941], [50.52645688, 18.10056758], [50.52644923, 18.10057574],
      [50.52644157, 18.10058389], [50.5264339, 18.10059203], [50.52642623, 18.10060017],
      [50.52641855, 18.10060829], [50.52641086, 18.10061641], [50.52640317, 18.10062452],
      [50.52639547, 18.10063262], [50.52638777, 18.10064071], [50.52638006, 18.10064879],
      [50.52637234, 18.10065686], [50.52636462, 18.10066493], [50.52635689, 18.10067298],
      [50.52634915, 18.10068103], [50.52634141, 18.10068907], [50.52633366, 18.1006971],
      [50.52632591, 18.10070512], [50.52631815, 18.10071313], [50.52631038, 18.10072113],
      [50.52630261, 18.10072912], [50.52629483, 18.1007371], [50.52628705, 18.10074508],
      [50.52627926, 18.10075304], [50.52627146, 18.100761], [50.52626366, 18.10076895],
      [50.52625585, 18.10077689], [50.52624804, 18.10078482], [50.52624022, 18.10079274],
      [50.52623239, 18.10080065], [50.52622456, 18.10080856], [50.52621672, 18.10081645],
      [50.52620888, 18.10082434], [50.52620103, 18.10083222], [50.52619317, 18.10084009],
      [50.52618531, 18.10084795], [50.52617744, 18.1008558], [50.52616957, 18.10086364],
      [50.52616169, 18.10087147], [50.5261538, 18.1008793], [50.52614591, 18.10088712],
      [50.52613801, 18.10089493], [50.5261301, 18.10090273], [50.52612219, 18.10091052],
      [50.52611427, 18.1009183], [50.52610635, 18.10092607], [50.52609842, 18.10093384],
      [50.52609048, 18.10094159], [50.52608254, 18.10094934], [50.52607459, 18.10095708],
      [50.52606664, 18.10096481], [50.52605868, 18.10097253], [50.52605071, 18.10098024],
      [50.52604274, 18.10098794], [50.52603476, 18.10099564], [50.52602677, 18.10100333],
      [50.52601878, 18.101011], [50.52601078, 18.10101867], [50.52600278, 18.10102633],
      [50.52599477, 18.10103398], [50.52598676, 18.10104162], [50.52597874, 18.10104925],
      [50.52597071, 18.10105687], [50.52596268, 18.10106448], [50.52595464, 18.10107209],
      [50.52594659, 18.10107968], [50.52593854, 18.10108727], [50.52593048, 18.10109485],
      [50.52592242, 18.10110242], [50.52591435, 18.10110998], [50.52590628, 18.10111753],
      [50.5258982, 18.10112507], [50.52589011, 18.1011326], [50.52588202, 18.10114013],
      [50.52587392, 18.10114764], [50.52586582, 18.10115515], [50.52585771, 18.10116265],
      [50.52584959, 18.10117014], [50.52584147, 18.10117762], [50.52583334, 18.10118509],
      [50.5258252, 18.10119255], [50.52581706, 18.10120001], [50.52580891, 18.10120745],
      [50.52580076, 18.10121489], [50.5257926, 18.10122232], [50.52578444, 18.10122974],
      [50.52577627, 18.10123715], [50.52576809, 18.10124455], [50.52575991, 18.10125194],
      [50.52575172, 18.10125933], [50.52574352, 18.1012667], [50.52573532, 18.10127407],
      [50.52572711, 18.10128143], [50.5257189, 18.10128878], [50.52571068, 18.10129612],
      [50.52570246, 18.10130345], [50.52569423, 18.10131077], [50.52568599, 18.10131809],
      [50.52567775, 18.10132539], [50.5256695, 18.10133269], [50.52566125, 18.10133998],
      [50.52565299, 18.10134726], [50.52564472, 18.10135453], [50.52563645, 18.10136179],
      [50.52562817, 18.10136904], [50.52561989, 18.10137629], [50.5256116, 18.10138352],
      [50.5256033, 18.10139075], [50.525595, 18.10139797], [50.52558669, 18.10140518],
      [50.52557838, 18.10141238], [50.52557006, 18.10141957], [50.52556173, 18.10142675],
      [50.5255534, 18.10143393], [50.52554506, 18.10144109], [50.52553672, 18.10144825],
      [50.52552837, 18.1014554], [50.52552001, 18.10146254], [50.52551165, 18.10146967],
      [50.52550328, 18.10147679], [50.52549491, 18.1014839], [50.52548653, 18.101491],
      [50.52547814, 18.1014981], [50.52546975, 18.10150518], [50.52546135, 18.10151226],
      [50.52545295, 18.10151933], [50.52544454, 18.10152639], [50.52543613, 18.10153344],
      [50.52542771, 18.10154048], [50.52541928, 18.10154751], [50.52541085, 18.10155454],
      [50.52540241, 18.10156155], [50.52539397, 18.10156856], [50.52538552, 18.10157556],
      [50.52537707, 18.10158255], [50.52536861, 18.10158953], [50.52536014, 18.10159651],
      [50.52535167, 18.10160347], [50.52534319, 18.10161043], [50.5253347, 18.10161738],
      [50.52532621, 18.10162432], [50.52531772, 18.10163125], [50.52530922, 18.10163817],
      [50.52530071, 18.10164508], [50.5252922, 18.10165199], [50.52528368, 18.10165888],
      [50.52527516, 18.10166577], [50.52526663, 18.10167265], [50.52525809, 18.10167952],
      [50.52524955, 18.10168638], [50.525241, 18.10169323], [50.52523245, 18.10170007],
      [50.52522389, 18.10170691], [50.52521533, 18.10171374], [50.52520676, 18.10172056],
      [50.52519819, 18.10172737], [50.52518961, 18.10173417], [50.52518102, 18.10174097],
      [50.52517243, 18.10174775], [50.52516383, 18.10175453], [50.52515523, 18.1017613],
      [50.52514662, 18.10176806], [50.525138, 18.10177481], [50.52512938, 18.10178155],
      [50.52512075, 18.10178829], [50.52511212, 18.10179501], [50.52510348, 18.10180173],
      [50.52509484, 18.10180844], [50.52508619, 18.10181514], [50.52507754, 18.10182183],
      [50.52506888, 18.10182851], [50.52506021, 18.10183519], [50.52505154, 18.10184185],
      [50.52504286, 18.10184851], [50.52503418, 18.10185516], [50.52502549, 18.1018618],
      [50.52501679, 18.10186843], [50.52500809, 18.10187505], [50.52499939, 18.10188167],
      [50.52499068, 18.10188827], [50.52498196, 18.10189487], [50.52497324, 18.10190146],
      [50.52496451, 18.10190804], [50.52495578, 18.10191461], [50.52494704, 18.10192117],
      [50.5249383, 18.10192772], [50.52492955, 18.10193427], [50.52492079, 18.1019408],
      [50.52491203, 18.10194733], [50.52490326, 18.10195385], [50.52489449, 18.10196036],
      [50.52488571, 18.10196686], [50.52487693, 18.10197335], [50.52486814, 18.10197984],
      [50.52485935, 18.10198631], [50.52485055, 18.10199278], [50.52484174, 18.10199924],
      [50.52483293, 18.10200569], [50.52482411, 18.10201213], [50.52481529, 18.10201856],
      [50.52480646, 18.10202499], [50.52479762, 18.1020314], [50.52478878, 18.10203781],
      [50.52477994, 18.10204421], [50.52477109, 18.1020506], [50.52476223, 18.10205698],
      [50.52475337, 18.10206335], [50.5247445, 18.10206972], [50.52473563, 18.10207607],
      [50.52472675, 18.10208242], [50.52471787, 18.10208876], [50.52470898, 18.10209509],
      [50.52470009, 18.10210141], [50.52469119, 18.10210772], [50.52468228, 18.10211403],
      [50.52467337, 18.10212032], [50.52466445, 18.10212661], [50.52465553, 18.10213289],
      [50.5246466, 18.10213916], [50.52463767, 18.10214542], [50.52462873, 18.10215167],
      [50.52461978, 18.10215791], [50.52461083, 18.10216415], [50.52460187, 18.10217037],
      [50.52459291, 18.10217659], [50.52458394, 18.1021828], [50.52457497, 18.102189],
      [50.52456599, 18.10219519], [50.524557, 18.10220137], [50.52454801, 18.10220754],
      [50.52453902, 18.1022137], [50.52453002, 18.10221985], [50.52452101, 18.102226],
      [50.524512, 18.10223213], [50.52450298, 18.10223826], [50.52449396, 18.10224438],
      [50.52448493, 18.10225049], [50.5244759, 18.10225659], [50.52446686, 18.10226268],
      [50.52445782, 18.10226876], [50.52444877, 18.10227483], [50.52443971, 18.1022809],
      [50.52443065, 18.10228695], [50.52442158, 18.102293], [50.52441251, 18.10229904],
      [50.52440343, 18.10230507], [50.52439435, 18.10231109], [50.52438526, 18.1023171],
      [50.52437617, 18.1023231], [50.52436707, 18.1023291], [50.52435796, 18.10233508],
      [50.52434885, 18.10234106], [50.52433974, 18.10234703], [50.52433062, 18.10235299],
      [50.52432149, 18.10235894], [50.52431236, 18.10236488], [50.52430322, 18.10237081],
      [50.52429408, 18.10237673], [50.52428493, 18.10238265], [50.52427578, 18.10238855],
      [50.52426662, 18.10239445], [50.52425746, 18.10240034], [50.52424829, 18.10240622],
      [50.52423911, 18.10241209], [50.52422993, 18.10241795], [50.52422075, 18.1024238],
      [50.52421156, 18.10242964], [50.52420236, 18.10243548], [50.52419316, 18.1024413],
      [50.52418395, 18.10244712], [50.52417474, 18.10245293], [50.52416552, 18.10245873],
      [50.5241563, 18.10246452], [50.52414707, 18.1024703], [50.52413784, 18.10247607],
      [50.5241286, 18.10248184], [50.52411936, 18.10248759], [50.52411011, 18.10249334],
      [50.52410085, 18.10249908], [50.52409159, 18.10250481], [50.52408232, 18.10251053],
      [50.52407305, 18.10251624], [50.52406377, 18.10252194], [50.52405449, 18.10252764],
      [50.5240452, 18.10253332], [50.52403591, 18.102539], [50.52402661, 18.10254467],
      [50.5240173, 18.10255033], [50.52400799, 18.10255598], [50.52399867, 18.10256162],
      [50.52398935, 18.10256726], [50.52398002, 18.10257289], [50.52397069, 18.1025785],
      [50.52396135, 18.10258411], [50.52395201, 18.10258971], [50.52394266, 18.1025953],
      [50.5239333, 18.10260088], [50.52392394, 18.10260645], [50.52391458, 18.10261201],
      [50.52390521, 18.10261757], [50.52389583, 18.10262311], [50.52388645, 18.10262865],
      [50.52387706, 18.10263418], [50.52386767, 18.1026397], [50.52385827, 18.10264521],
      [50.52384887, 18.10265071], [50.52383946, 18.1026562], [50.52383005, 18.10266168],
      [50.52382063, 18.10266715], [50.52381121, 18.10267262], [50.52380178, 18.10267807],
      [50.52379234, 18.10268352], [50.5237829, 18.10268896], [50.52377345, 18.10269439],
      [50.523764, 18.10269981], [50.52375454, 18.10270522], [50.52374508, 18.10271062],
      [50.52373561, 18.10271602], [50.52372614, 18.1027214], [50.52371666, 18.10272678],
      [50.52370717, 18.10273215], [50.52369768, 18.10273751], [50.52368818, 18.10274286],
      [50.52367868, 18.1027482], [50.52366917, 18.10275353], [50.52365966, 18.10275885],
      [50.52365014, 18.10276417], [50.52364061, 18.10276947], [50.52363108, 18.10277477],
      [50.52362154, 18.10278006], [50.52361199, 18.10278534], [50.52360244, 18.10279061],
      [50.52359289, 18.10279587], [50.52358333, 18.10280112], [50.52357376, 18.10280636],
      [50.52356419, 18.1028116], [50.52355461, 18.10281682], [50.52354503, 18.10282204],
      [50.52353544, 18.10282725], [50.52352585, 18.10283245], [50.52351625, 18.10283764],
      [50.52350664, 18.10284282], [50.52349703, 18.10284799], [50.52348741, 18.10285315],
      [50.52347779, 18.1028583], [50.52346816, 18.10286344], [50.52345853, 18.10286858],
      [50.52344889, 18.1028737], [50.52343925, 18.10287882], [50.5234296, 18.10288393],
      [50.52341994, 18.10288903], [50.52341028, 18.10289412], [50.52340061, 18.1028992],
      [50.52339094, 18.10290427], [50.52338126, 18.10290933], [50.52337158, 18.10291439],
      [50.52336189, 18.10291943], [50.52335219, 18.10292447], [50.52334249, 18.1029295],
      [50.52333278, 18.10293452], [50.52332307, 18.10293953], [50.52331335, 18.10294453],
      [50.52330363, 18.10294952], [50.5232939, 18.10295451], [50.52328416, 18.10295948],
      [50.52327442, 18.10296445], [50.52326467, 18.10296941], [50.52325492, 18.10297436],
      [50.52324516, 18.1029793], [50.5232354, 18.10298423], [50.52322563, 18.10298915],
      [50.52321585, 18.10299406], [50.52320607, 18.10299897], [50.52319628, 18.10300386],
      [50.52318649, 18.10300875], [50.52317669, 18.10301363], [50.52316689, 18.1030185],
      [50.52315708, 18.10302336], [50.52314726, 18.10302822], [50.52313744, 18.10303306],
      [50.52312761, 18.1030379], [50.52311778, 18.10304273], [50.52310794, 18.10304755],
      [50.52309809, 18.10305236], [50.52308824, 18.10305716], [50.52307838, 18.10306195],
      [50.52306852, 18.10306674], [50.52305865, 18.10307151], [50.52304878, 18.10307628],
      [50.5230389, 18.10308104], [50.52302901, 18.10308579], [50.52301912, 18.10309053],
      [50.52300922, 18.10309526], [50.52299932, 18.10309998], [50.52298941, 18.1031047],
      [50.52297949, 18.1031094], [50.52296957, 18.1031141], [50.52295964, 18.10311879],
      [50.52294971, 18.10312347], [50.52293977, 18.10312814], [50.52292983, 18.10313281],
      [50.52291988, 18.10313746], [50.52290992, 18.10314211], [50.52289996, 18.10314675],
      [50.52288999, 18.10315138], [50.52288001, 18.103156], [50.52287003, 18.10316061],
      [50.52286004, 18.10316521], [50.52285005, 18.1031698], [50.52284005, 18.10317439],
      [50.52283004, 18.10317896], [50.52282003, 18.10318353], [50.52281001, 18.10318809],
      [50.52279999, 18.10319264], [50.52278996, 18.10319718], [50.52277992, 18.10320171],
      [50.52276988, 18.10320623], [50.52275983, 18.10321074], [50.52274978, 18.10321525],
      [50.52273972, 18.10321974], [50.52272965, 18.10322423], [50.52271958, 18.10322871],
      [50.5227095, 18.10323318], [50.52269942, 18.10323764], [50.52268933, 18.10324209],
      [50.52267923, 18.10324653], [50.52266913, 18.10325097], [50.52265902, 18.10325539],
      [50.52264891, 18.10325981], [50.52263879, 18.10326422], [50.52262866, 18.10326862],
      [50.52261853, 18.10327301], [50.52260839, 18.10327739], [50.52259825, 18.10328176],
      [50.5225881, 18.10328612], [50.52257794, 18.10329048], [50.52256778, 18.10329482],
      [50.52255761, 18.10329916], [50.52254744, 18.10330349], [50.52253726, 18.10330781],
      [50.52252707, 18.10331212], [50.52251688, 18.10331642], [50.52250668, 18.10332071],
      [50.52249648, 18.103325], [50.52248627, 18.10332927], [50.52247605, 18.10333354],
      [50.52246583, 18.1033378], [50.5224556, 18.10334205], [50.52244536, 18.10334629],
      [50.52243512, 18.10335052], [50.52242487, 18.10335474], [50.52241462, 18.10335895],
      [50.52240436, 18.10336315], [50.52239409, 18.10336734], [50.52238382, 18.10337153],
      [50.52237354, 18.1033757], [50.52236326, 18.10337987], [50.52235297, 18.10338403],
      [50.52234267, 18.10338818], [50.52233237, 18.10339232], [50.52232206, 18.10339645],
      [50.52231174, 18.10340057], [50.52230142, 18.10340468], [50.52229109, 18.10340878],
      [50.52228076, 18.10341288], [50.52227042, 18.10341696], [50.52226007, 18.10342104],
      [50.52224972, 18.10342511], [50.52223936, 18.10342917], [50.522229, 18.10343322],
      [50.52221863, 18.10343726], [50.52220825, 18.1034413], [50.52219787, 18.10344532],
      [50.52218748, 18.10344934], [50.52217708, 18.10345335], [50.52216668, 18.10345735],
      [50.52215627, 18.10346134], [50.52214585, 18.10346532], [50.52213543, 18.10346929],
      [50.522125, 18.10347325], [50.52211457, 18.1034772], [50.52210413, 18.10348114],
      [50.52209368, 18.10348508], [50.52208323, 18.103489], [50.52207277, 18.10349292],
      [50.5220623, 18.10349683], [50.52205183, 18.10350073], [50.52204135, 18.10350462],
      [50.52203086, 18.1035085], [50.52202037, 18.10351237], [50.52200987, 18.10351623],
      [50.52199937, 18.10352008], [50.52198886, 18.10352393], [50.52197834, 18.10352776],
      [50.52196782, 18.10353159], [50.52195729, 18.10353541], [50.52194675, 18.10353922],
      [50.52193621, 18.10354302], [50.52192566, 18.10354681], [50.5219151, 18.10355059],
      [50.52190454, 18.10355436], [50.52189397, 18.10355812], [50.52188339, 18.10356188],
      [50.52187281, 18.10356562], [50.52186222, 18.10356936], [50.52185162, 18.10357309],
      [50.52184102, 18.1035768], [50.52183041, 18.10358051], [50.52181979, 18.10358421],
      [50.52180917, 18.1035879], [50.52179854, 18.10359158], [50.5217879, 18.10359525],
      [50.52177726, 18.10359891], [50.52176661, 18.10360256], [50.52175595, 18.1036062],
      [50.52174529, 18.10360983], [50.52173462, 18.10361345], [50.52172394, 18.10361707],
      [50.52171326, 18.10362067], [50.52170257, 18.10362426], [50.52169187, 18.10362785],
      [50.52168117, 18.10363142], [50.52167046, 18.10363499], [50.52165974, 18.10363855],
      [50.52164902, 18.1036421], [50.52163829, 18.10364564], [50.52162755, 18.10364917],
      [50.52161681, 18.10365269], [50.52160606, 18.1036562], [50.5215953, 18.1036597],
      [50.52158454, 18.10366319], [50.52157377, 18.10366667], [50.52156299, 18.10367014],
      [50.52155221, 18.1036736], [50.52154142, 18.10367705], [50.52153062, 18.10368049],
      [50.52151982, 18.10368392], [50.52150901, 18.10368734], [50.52149819, 18.10369075],
      [50.52148737, 18.10369415], [50.52147654, 18.10369754], [50.5214657, 18.10370092],
      [50.52145486, 18.10370429], [50.52144401, 18.10370765], [50.52143315, 18.103711],
      [50.52142229, 18.10371434], [50.52141142, 18.10371767], [50.52140054, 18.10372099],
      [50.52138966, 18.1037243],       [50.52135697, 18.10373417], [50.52927545, 18.09601748] // Retour au point de départ
    ];

    // Initialisation de la carte
    const map = L.map('map').setView(circuitConfig.centre, circuitConfig.zoom);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // Variables globales de suivi
    let marker = null;
    let tempsDepart = null;
    let secteurActuel = 0;
    let retardAccumule = 0;
    let strategieActuelle = 'normal';
    let multiplicateurVitesse = 1.0;
    let courseEnCours = false;
    let gpsPointsCount = 0;
    let dernierPositionRecu = null;

    // Éléments DOM
    const coordsEl = document.getElementById('coords');
    const secteurEl = document.getElementById('secteur');
    const vitesseOptEl = document.getElementById('vitesse-opt');
    const tempsEl = document.getElementById('temps');
    const retardEl = document.getElementById('retard');
    const gpsPointsEl = document.getElementById('gps-points');
    const vitesseActuelleEl = document.getElementById('vitesse-actuelle');
    const progressionEl = document.getElementById('progression');
    const raceStatusEl = document.getElementById('race-status');
    const raceStatusTextEl = document.getElementById('race-status-text');
    const modeActuelEl = document.getElementById('mode-actuel');
    const tempsCibleEl = document.getElementById('temps-cible');

    // Dessiner le circuit complet
    const circuitLine = L.polyline(traceCircuitComplet, {
      color: '#0066cc',
      weight: 4,
      opacity: 0.8
    }).addTo(map);

    // Ajouter des marqueurs pour les secteurs
    function dessinerSecteurs() {
      circuitConfig.secteurs.forEach(secteur => {
        let couleur = '#28a745'; // Vert (rapide)
        if (secteur.type === 'epingle') couleur = '#dc3545'; // Rouge (très lent)
        else if (secteur.type === 'lent') couleur = '#fd7e14'; // Orange (lent)
        else if (secteur.type === 'moyen') couleur = '#ffc107'; // Jaune (moyen)
        else if (secteur.type === 'ligne_droite') couleur = '#6f42c1'; // Violet (ligne droite)

        const circle = L.circle(secteur.debut, {
          radius: 8,
          fillColor: couleur,
          color: couleur,
          weight: 2,
          fillOpacity: 0.7
        }).addTo(map);

        circle.bindPopup(`
          <strong>Secteur ${secteur.id + 1}</strong><br>
          Type: ${secteur.type}<br>
          Vitesse optimale: ${secteur.vitesseOptimale} km/h<br>
          Temps optimal: ${secteur.tempsOptimal.toFixed(1)}s
        `);
      });
    }

    dessinerSecteurs();

    // Fonctions utilitaires
    function calculerDistance(lat1, lon1, lat2, lon2) {
      const R = 6371e3;
      const φ1 = lat1 * Math.PI/180;
      const φ2 = lat2 * Math.PI/180;
      const Δφ = (lat2-lat1) * Math.PI/180;
      const Δλ = (lon2-lon1) * Math.PI/180;

      const a = Math.sin(Δφ/2) * Math.sin(Δφ/2) +
                Math.cos(φ1) * Math.cos(φ2) *
                Math.sin(Δλ/2) * Math.sin(Δλ/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

      return R * c;
    }

    function determinerSecteur(lat, lon) {
      let secteurProche = 0;
      let distanceMin = Infinity;

      circuitConfig.secteurs.forEach(secteur => {
        const distance = calculerDistance(lat, lon, secteur.debut[0], secteur.debut[1]);
        if (distance < distanceMin) {
          distanceMin = distance;
          secteurProche = secteur.id;
        }
      });

      return secteurProche;
    }

    function calculerRetard(lat, lon) {
      if (!tempsDepart || !courseEnCours) return 0;

      const tempsEcoule = (Date.now() - tempsDepart) / 1000;
      const nouveauSecteur = determinerSecteur(lat, lon);

      // Calculer le temps optimal jusqu'au secteur actuel
      let tempsOptimalCumul = 0;
      for (let i = 0; i <= nouveauSecteur && i < circuitConfig.secteurs.length; i++) {
        tempsOptimalCumul += circuitConfig.secteurs[i].tempsOptimal * multiplicateurVitesse;
      }

      const retard = tempsEcoule - tempsOptimalCumul;
      
      if (nouveauSecteur !== secteurActuel) {
        secteurActuel = nouveauSecteur;
        mettreAJourAffichageSecteur();
      }

      return retard;
    }

    function mettreAJourAffichageSecteur() {
      if (secteurActuel < circuitConfig.secteurs.length) {
        const secteur = circuitConfig.secteurs[secteurActuel];
        secteurEl.textContent = `${secteurActuel + 1}/${circuitConfig.secteurs.length}`;
        vitesseOptEl.textContent = `${Math.round(secteur.vitesseOptimale * multiplicateurVitesse)} km/h`;
        
        const progression = ((secteurActuel + 1) / circuitConfig.secteurs.length * 100);
        progressionEl.textContent = progression.toFixed(0);
      }
    }

    function mettreAJourAffichageRetard(retard) {
      const retardFormate = (retard >= 0 ? '+' : '') + retard.toFixed(1) + 's';
      retardEl.textContent = retardFormate;

      // Changer la couleur selon le retard
      retardEl.className = 'info-value ';
      if (retard < -2) {
        retardEl.classList.add('status-ok'); // En avance
      } else if (retard < 2) {
        retardEl.classList.add('status-ok'); // Dans les temps
      } else if (retard < 5) {
        retardEl.classList.add('status-warning'); // Léger retard
      } else {
        retardEl.classList.add('status-danger'); // Retard important
        
        // Alerte automatique pour retard critique
        if (retard > 10 && strategieActuelle === 'normal') {
          changeStrategy('attaque');
          showNotification('⚠️ Retard critique détecté! Passage automatique en mode Attaque.', 'warning');
        }
      }
    }

    function calculerVitesse() {
      if (!dernierPositionRecu || gpsPointsCount < 2) return 0;
      
      // Simulation basique de vitesse basée sur la fréquence de réception
      const vitesseEstimee = Math.random() * 20 + 40; // 40-60 km/h simulé
      return vitesseEstimee;
    }

    function updateMarker(lat, lon) {
      gpsPointsCount++;
      dernierPositionRecu = { lat, lon, timestamp: Date.now() };
      
      // Mettre à jour les coordonnées
      coordsEl.textContent = `${lat.toFixed(6)}, ${lon.toFixed(6)}`;
      gpsPointsEl.textContent = gpsPointsCount;

      // Calculer et afficher la vitesse
      const vitesse = calculerVitesse();
      vitesseActuelleEl.textContent = vitesse.toFixed(0);

      // Calculer le retard
      const retard = calculerRetard(lat, lon);
      mettreAJourAffichageRetard(retard);

      // Mettre à jour le temps écoulé
      if (tempsDepart && courseEnCours) {
        const tempsEcoule = (Date.now() - tempsDepart) / 1000;
        tempsEl.textContent = `${tempsEcoule.toFixed(1)}s`;
      }

      // Mettre à jour ou créer le marqueur
      if (!marker) {
        marker = L.circleMarker([lat, lon], {
          radius: 12,
          fillColor: '#ff0000',
          color: '#ffffff',
          weight: 3,
          fillOpacity: 0.9
        }).addTo(map);
        map.panTo([lat, lon]);
      } else {
        marker.setLatLng([lat, lon]);
        map.panTo([lat, lon]);
      }

      // Changer la couleur du marqueur selon le retard
      let couleurMarqueur = '#00ff00'; // Vert par défaut
      if (retard > 5) couleurMarqueur = '#ff0000'; // Rouge si retard
      else if (retard > 2) couleurMarqueur = '#ffa500'; // Orange si léger retard
      else if (retard < -2) couleurMarqueur = '#0066ff'; // Bleu si en avance
      
      marker.setStyle({ fillColor: couleurMarqueur });
    }

    // Gestion des stratégies
    function changeStrategy(nouvelleStrategie) {
      if (nouvelleStrategie === strategieActuelle) return;
      
      const ancienneStrategie = strategieActuelle;
      strategieActuelle = nouvelleStrategie;
      
      // Mettre à jour les multiplicateurs de vitesse
      switch(nouvelleStrategie) {
        case 'economie':
          multiplicateurVitesse = 0.85; // -15% vitesse
          break;
        case 'normal':
          multiplicateurVitesse = 1.0;
          break;
        case 'attaque':
          multiplicateurVitesse = 1.2; // +20% vitesse
          break;
      }

      // Mettre à jour l'interface
      document.querySelectorAll('.strategy-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`.btn-${nouvelleStrategie === 'attaque' ? 'attack' : nouvelleStrategie}`)
        .classList.add('active');
      
      modeActuelEl.textContent = nouvelleStrategie.charAt(0).toUpperCase() + nouvelleStrategie.slice(1);
      
      // Recalculer le temps cible
      const tempsOptimalTotal = circuitConfig.secteurs.reduce((sum, s) => sum + s.tempsOptimal, 0);
      const tempsCible = tempsOptimalTotal * multiplicateurVitesse;
      tempsCibleEl.textContent = `${tempsCible.toFixed(1)}s`;

      // Notifier le serveur du changement de stratégie
      socket.emit('changement-strategie', {
        from: ancienneStrategie,
        to: nouvelleStrategie,
        multiplicateur: multiplicateurVitesse,
        secteur: secteurActuel,
        timestamp: Date.now()
      });

      showNotification(`🎯 Stratégie changée: ${nouvelleStrategie}`, 'success');
      console.log(`🏁 Stratégie changée: ${ancienneStrategie} → ${nouvelleStrategie} (x${multiplicateurVitesse})`);
    }

    // Contrôles de course
    function startRace() {
      if (courseEnCours) return;
      
      courseEnCours = true;
      tempsDepart = Date.now();
      secteurActuel = 0;
      retardAccumule = 0;
      gpsPointsCount = 0;
      
      // Mise à jour interface
      raceStatusEl.className = 'race-status';
      raceStatusTextEl.textContent = 'Course en cours';
      
      // Notification au serveur
      socket.emit('race-start', {
        timestamp: tempsDepart,
        strategy: strategieActuelle
      });
      
      showNotification('🚀 Course démarrée!', 'success');
      console.log('🏁 Course démarrée');
    }

    function stopRace() {
      if (!courseEnCours) return;
      
      courseEnCours = false;
      const duree = tempsDepart ? (Date.now() - tempsDepart) / 1000 : 0;
      
      // Mise à jour interface
      raceStatusEl.className = 'race-status';
      raceStatusTextEl.textContent = `Arrêtée (${duree.toFixed(1)}s)`;
      
      // Notification au serveur
      socket.emit('race-stop', {
        timestamp: Date.now(),
        duration: duree,
        points: gpsPointsCount
      });
      
      showNotification(`⏹️ Course arrêtée après ${duree.toFixed(1)}s`, 'warning');
      console.log(`🏁 Course arrêtée après ${duree.toFixed(1)}s`);
    }

    function resetRace() {
      courseEnCours = false;
      tempsDepart = null;
      secteurActuel = 0;
      retardAccumule = 0;
      gpsPointsCount = 0;
      dernierPositionRecu = null;
      
      // Reset interface
      coordsEl.textContent = '--, --';
      secteurEl.textContent = '--/27';
      vitesseOptEl.textContent = '-- km/h';
      tempsEl.textContent = '--';
      retardEl.textContent = '+0.0s';
      retardEl.className = 'info-value status-ok';
      gpsPointsEl.textContent = '0';
      vitesseActuelleEl.textContent = '0';
      progressionEl.textContent = '0';
      raceStatusTextEl.textContent = 'En attente';
      raceStatusEl.className = 'race-status';
      
      // Supprimer le marqueur
      if (marker) {
        map.removeLayer(marker);
        marker = null;
      }
      
      socket.emit('race-reset');
      showNotification('🔄 Course réinitialisée', 'success');
      console.log('🔄 Course réinitialisée');
    }

    // Système de notifications
    function showNotification(message, type = 'info') {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.className = `notification ${type} show`;
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    // Communication WebSocket
    socket.emit('requestLatest');

    socket.on('position', (data) => {
      const { lat, lon } = data;
      updateMarker(lat, lon);
    });

    socket.on('strategy-change', (data) => {
      console.log('📡 Changement de stratégie reçu:', data);
      if (data.to && data.to !== strategieActuelle) {
        changeStrategy(data.to);
      }
    });

    socket.on('race-start', () => {
      if (!courseEnCours) {
        startRace();
      }
    });

    socket.on('race-stop', () => {
      if (courseEnCours) {
        stopRace();
      }
    });

    socket.on('race-reset', () => {
      resetRace();
    });

    socket.on('connect', () => {
      console.log('✅ Connecté au serveur');
      showNotification('🌐 Connecté au serveur', 'success');
    });

    socket.on('disconnect', () => {
      console.log('❌ Déconnecté du serveur');
      showNotification('❌ Connexion perdue', 'error');
    });

    // Fonctions globales pour les boutons
    window.changeStrategy = changeStrategy;
    window.startRace = startRace;
    window.stopRace = stopRace;
    window.resetRace = resetRace;

    // Initialisation
    changeStrategy('normal');
    
    console.log('🏁 Dashboard Eta-One Racing initialisé!');
    console.log('📍 Circuit: Sosnová (République Tchèque)');
    console.log('⏱️ Temps optimal: 81.6 secondes');
    console.log('🎯 ' + circuitConfig.secteurs.length + ' secteurs configurés');
  </script>
</body>
</html><!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Eta-One Racing - Dashboard</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    html, body, #map { margin: 0; padding: 0; height: 100vh; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    
    /* Panneau d'informations GPS */
    #info-panel {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(255, 255, 255, 0.95);
      padding: 15px;
      border-radius: 12px;
      font-family: 'Segoe UI', sans-serif;
      z-index: 1000;
      min-width: 280px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    #info-panel h4 {
      margin: 0 0 15px 0;
      color: #2c3e50;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 8px 0;
      padding: 4px 0;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .info-row:last-child {
      border-bottom: none;
    }
    
    .info-label {
      font-weight: 500;
      color: #555;
    }
    
    .info-value {
      font-weight: bold;
      color: #2c3e50;
    }
    
    /* Panneau de stratégie */
    #strategy-panel {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 12px;
      font-family: 'Segoe UI', sans-serif;
      z-index: 1000;
      min-width: 320px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    #strategy-panel h4 {
      margin: 0 0 15px 0;
      color: #2c3e50;
      font-size: 1.2rem;
    }
    
    /* Métriques de performance */
    .metrics-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 15px 0;
    }
    
    .metric-card {
      background: rgba(52, 152, 219, 0.1);
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      border: 1px solid rgba(52, 152, 219, 0.2);
    }
    
    .metric-value {
      font-size: 1.4rem;
      font-weight: bold;
      color: #2980b9;
    }
    
    .metric-label {
      font-size: 0.9rem;
      color: #7f8c8d;
      margin-top: 4px;
    }
    
    /* Boutons de stratégie */
    .strategy-controls {
      margin: 15px 0;
    }
    
    .strategy-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 8px;
      margin: 10px 0;
    }
    
    .strategy-btn {
      padding: 12px 8px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s ease;
      color: white;
      text-align: center;
    }
    
    .strategy-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    
    .strategy-btn.active {
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.8), 0 0 0 5px currentColor;
      transform: scale(1.05);
    }
    
    .btn-eco { background: linear-gradient(135deg, #27ae60, #2ecc71); }
    .btn-normal { background: linear-gradient(135deg, #3498db, #2980b9); }
    .btn-attack { background: linear-gradient(135deg, #e74c3c, #c0392b); }
    
    /* Indicateurs de statut */
    .status-ok { color: #27ae60; font-weight: bold; }
    .status-warning { color: #f39c12; font-weight: bold; }
    .status-danger { color: #e74c3c; font-weight: bold; }
    
    /* Informations de course */
    .race-status {
      background: rgba(46, 204, 113, 0.1);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid rgba(46, 204, 113, 0.2);
      margin: 15px 0;
    }
    
    .race-status.warning {
      background: rgba(243, 156, 18, 0.1);
      border-color: rgba(243, 156, 18, 0.2);
    }
    
    .race-status.danger {
      background: rgba(231, 76, 60, 0.1);
      border-color: rgba(231, 76, 60, 0.2);
    }
    
    /* Contrôles de course */
    .race-controls {
      margin: 15px 0;
      padding: 15px 0;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .control-btn {
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s ease;
    }
    
    .btn-start { background: #27ae60; color: white; }
    .btn-stop { background: #e74c3c; color: white; }
    .btn-reset { background: #95a5a6; color: white; }
    
    .control-btn:hover { opacity: 0.8; transform: translateY(-1px); }
    .control-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    
    /* Circuit info */
    .circuit-info {
      font-size: 0.85rem;
      color: #7f8c8d;
      text-align: center;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    /* Notifications */
    .notification {
      position: absolute;
      top: 50px;
      left: 50%;
      transform: translateX(-50%);
      background: #2c3e50;
      color: white;
      padding: 15px 25px;
      border-radius: 8px;
      z-index: 10000;
      font-weight: 500;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .notification.show {
      opacity: 1;
    }
    
    .notification.success { background: #27ae60; }
    .notification.warning { background: #f39c12; }
    .notification.error { background: #e74c3c; }
  </style>
</head>
<body>
  <div id="map"></div>
  
  <!-- Panneau d'informations GPS -->
  <div id="info-panel">
    <h4>📍 Position GPS</h4>
    
    <div class="info-row">
      <span class="info-label">Coordonnées:</span>
      <span class="info-value" id="coords">--, --</span>
    </div>
    
    <div class="info-row">
      <span class="info-label">Secteur:</span>
      <span class="info-value" id="secteur">--/27</span>
    </div>
    
    <div class="info-row">
      <span class="info-label">Vitesse opt:</span>
      <span class="info-value" id="vitesse-opt">-- km/h</span>
    </div>
    
    <div class="info-row">
      <span class="info-label">Temps écoulé:</span>
      <span class="info-value" id="temps">--</span>
    </div>
    
    <div class="info-row">
      <span class="info-label">Retard:</span>
      <span class="info-value status-ok" id="retard">+0.0s</span>
    </div>
    
    <div class="info-row">
      <span class="info-label">Points GPS:</span>
      <span class="info-value" id="gps-points">0</span>
    </div>
  </div>

  <!-- Panneau de stratégie -->
  <div id="strategy-panel">
    <h4>🏁 Contrôle de Course</h4>
    
    <!-- Métriques de performance -->
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-value" id="vitesse-actuelle">0</div>
        <div class="metric-label">km/h</div>
      </div>
      <div class="metric-card">
        <div class="metric-value" id="progression">0</div>
        <div class="metric-label">% circuit</div>
      </div>
    </div>
    
    <!-- Statut de course -->
    <div id="race-status" class="race-status">
      <strong>🟢 Statut:</strong> <span id="race-status-text">En attente</span>
    </div>
    
    <!-- Contrôles de stratégie -->
    <div class="strategy-controls">
      <div style="font-weight: 500; margin-bottom: 8px;">Stratégie Active:</div>
      
      <div class="strategy-buttons">
        <button class="strategy-btn btn-eco" onclick="changeStrategy('economie')">
          🔋<br>Économie
        </button>
        <button class="strategy-btn btn-normal active" onclick="changeStrategy('normal')">
          🏃<br>Normal
        </button>
        <button class="strategy-btn btn-attack" onclick="changeStrategy('attaque')">
          ⚡<br>Attaque
        </button>
      </div>
      
      <div style="text-align: center; font-size: 0.9rem; color: #666;">
        Mode: <strong id="mode-actuel">Normal</strong> | 
        Cible: <strong id="temps-cible">81.6s</strong>
      </div>
    </div>
    
    <!-- Contrôles de course -->
    <div class="race-controls">
      <button class="control-btn btn-start" onclick="startRace()">▶️ Démarrer</button>
      <button class="control-btn btn-stop" onclick="stopRace()" disabled>⏹️ Arrêter</button>
      <button class="control-btn btn-reset" onclick="resetRace()">🔄 Reset</button>
    </div>
    
    <!-- Informations circuit -->
    <div class="circuit-info">
      🏆 Circuit de Sosnová (CZ)<br>
      📏 Distance: 1321m | ⏱️ Record: 81.6s<br>
      🎯 Consommation cible: < 50ml
    </div>
  </div>

  <!-- Zone de notifications -->
  <div id="notification" class="notification"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    // Configuration du circuit Sosnová avec secteurs complets
    const circuitConfig = {
      centre: [50.529211, 18.093939],
      zoom: 16,
      secteurs: [
        {id: 0, debut: [50.52927545, 18.09601748], vitesseOptimale: 68, tempsOptimal: 2.1, type: 'rapide'},
        {id: 1, debut: [50.52919987, 18.09628445], vitesseOptimale: 57, tempsOptimal: 2.5, type: 'moyen'},
        {id: 2, debut: [50.52917447, 18.09645162], vitesseOptimale: 43, tempsOptimal: 3.3, type: 'lent'},
        {id: 3, debut: [50.52913776, 18.09657364], vitesseOptimale: 30, tempsOptimal: 4.8, type: 'epingle'},
        {id: 4, debut: [50.52908994, 18.09666081], vitesseOptimale: 46, tempsOptimal: 3.1, type: 'moyen'},
        {id: 5, debut: [50.52904102, 18.09670833], vitesseOptimale: 59, tempsOptimal: 2.4, type: 'rapide'},
        {id: 6, debut: [50.52898118, 18.09673132], vitesseOptimale: 62, tempsOptimal: 2.3, type: 'rapide'},
        {id: 7, debut: [50.52891061, 18.09671017], vitesseOptimale: 65, tempsOptimal: 2.2, type: 'rapide'},
        {id: 8, debut: [50.5288493, 18.09666918], vitesseOptimale: 53, tempsOptimal: 2.7, type: 'moyen'},
        {id: 9, debut: [50.52879725, 18.09661836], vitesseOptimale: 30, tempsOptimal: 4.8, type: 'epingle'},
        {id: 10, debut: [50.52876043, 18.09655771], vitesseOptimale: 51, tempsOptimal: 2.8, type: 'moyen'},
        {id: 11, debut: [50.52873866, 18.09648323], vitesseOptimale: 62, tempsOptimal: 2.3, type: 'rapide'},
        {id: 12, debut: [50.52873194, 18.09640493], vitesseOptimale: 54, tempsOptimal: 2.7, type: 'moyen'},
        {id: 13, debut: [50.52874026, 18.0963228], vitesseOptimale: 42, tempsOptimal: 3.4, type: 'lent'},
        {id: 14, debut: [50.52876362, 18.09624686], vitesseOptimale: 34, tempsOptimal: 4.2, type: 'lent'},
        {id: 15, debut: [50.52880201, 18.0961771], vitesseOptimale: 62, tempsOptimal: 2.3, type: 'rapide'},
        {id: 16, debut: [50.52885543, 18.09611353], vitesseOptimale: 65, tempsOptimal: 2.2, type: 'rapide'},
        {id: 17, debut: [50.52892389, 18.09605614], vitesseOptimale: 40, tempsOptimal: 3.6, type: 'lent'},
        {id: 18, debut: [50.52900738, 18.09600493], vitesseOptimale: 46, tempsOptimal: 3.1, type: 'moyen'},
        {id: 19, debut: [50.5291059, 18.09595992], vitesseOptimale: 62, tempsOptimal: 2.3, type: 'rapide'},
        {id: 20, debut: [50.52921945, 18.09592109], vitesseOptimale: 47, tempsOptimal: 3.1, type: 'moyen'},
        {id: 21, debut: [50.52925123, 18.09595432], vitesseOptimale: 25, tempsOptimal: 5.8, type: 'epingle'},
        {id: 22, debut: [50.52926891, 18.09598756], vitesseOptimale: 40, tempsOptimal: 3.6, type: 'lent'},
        {id: 23, debut: [50.52927324, 18.09600234], vitesseOptimale: 35, tempsOptimal: 4.1, type: 'lent'},
        {id: 24, debut: [50.52927467, 18.09601345], vitesseOptimale: 62, tempsOptimal: 2.3, type: 'rapide'},
        {id: 25, debut: [50.52927521, 18.09601623], vitesseOptimale: 65, tempsOptimal: 2.2, type: 'rapide'},
        {id: 26, debut: [50.52927545, 18.09601748], vitesseOptimale: 70, tempsOptimal: 1.0, type: 'ligne_droite'}
      ]
    };

    // Tracé détaillé du circuit (coordonnées complètes)
    const traceCircuitComplet = [
      [50.52927545, 18.09601748], [50.52927056, 18.09602932], [50.52926566, 18.09604115],
      [50.52926075, 18.09605298], [50.52925584, 18.0960648], [50.52925092, 18.09607663],
      [50.529246, 18.09608845], [50.52924107, 18.09610027], [50.52923614, 18.09611209],
      [50.5292312, 18.0961239], [50.52922626, 18.09613571], [50.52922131, 18.09614752],
      [50.52921636, 18.09615932], [50.5292114, 18.09617112], [50.52920644, 18.09618292],
      [50.52920147, 18.09619471], [50.52919649, 18.0962065], [50.52919151, 18.09621829],
      [50.52918652, 18.09623007], [50.52918152, 18.09624184], [50.52917652, 18.09625361],
      [50.52917151, 18.09626538], [50.52916649, 18.09627714], [50.52916147, 18.09628889],
      [50.52915644, 18.09630064], [50.52915141, 18.09631238], [50.52914637, 18.09632412],
      [50.52914132, 18.09633585], [50.52913627, 18.09634758], [50.52913121, 18.0963593],
      [50.52912614, 18.09637101], [50.52912107, 18.09638272], [50.52911599, 18.09639442],
      [50.5291109, 18.09640612], [50.52910581, 18.09641781], [50.52910071, 18.09642949],
      [50.52909561, 18.09644117], [50.52909049, 18.09645284], [50.52908537, 18.0964645],
      [50.52908025, 18.09647616], [50.52907512, 18.09648781], [50.52906998, 18.09649945],
      [50.52906484, 18.09651109], [50.52905969, 18.09652272], [50.52905453, 18.09653434],
      [50.52904937, 18.09654595], [50.5290442, 18.09655756], [50.52903902, 18.09656916],
      [50.52903384, 18.09658075], [50.52902865, 18.09659234], [50.52902346, 18.09660392],
      [50.52901826, 18.09661549], [50.52901305, 18.09662705], [50.52900784, 18.09663861],
      [50.52900262, 18.09665016], [50.52899739, 18.0966617], [50.52899216, 18.09667324],
      [50.52898692, 18.09668477], [50.52898167, 18.09669629], [50.52897642, 18.0967078],
      [50.52897116, 18.09671931], [50.52896589, 18.0967308], [50.52896062, 18.09674229],
      [50.52895534, 18.09675377], [50.52895005, 18.09676525], [50.52894476, 18.09677671],
      [50.52893946, 18.09678817], [50.52893415, 18.09679962], [50.52892884, 18.09681106],
      [50.52892352, 18.09682249], [50.52891819, 18.09683392], [50.52891286, 18.09684533],
      [50.52890752, 18.09685674], [50.52890217, 18.09686814], [50.52889682, 18.09687953],
      [50.52889146, 18.09689091], [50.5288861, 18.09690229], [50.52888073, 18.09691365],
      [50.52887535, 18.09692501], [50.52886997, 18.09693636], [50.52886458, 18.0969477],
      [50.52885918, 18.09695903], [50.52885378, 18.09697035], [50.52884837, 18.09698167],
      [50.52884295, 18.09699297], [50.52883753, 18.09700427], [50.5288321, 18.09701556],
      [50.52882667, 18.09702684], [50.52882123, 18.09703811], [50.52881578, 18.09704937],
      [50.52881033, 18.09706063], [50.52880487, 18.09707187], [50.5287994, 18.09708311],
      [50.52879393, 18.09709434], [50.52878845, 18.09710556], [50.52878297, 18.09711677],
      [50.52877748, 18.09712797], [50.52877198, 18.09713916], [50.52876648, 18.09715035],
      [50.52876097, 18.09716152], [50.52875546, 18.09717269], [50.52874994, 18.09718385],
      [50.52874441, 18.099195], [50.52873888, 18.09720614], [50.52873334, 18.09721727],
      [50.52872779, 18.09722839], [50.52872224, 18.0972395], [50.52871668, 18.0972506],
      [50.52871112, 18.09726169], [50.52870555, 18.09727278], [50.52869997, 18.09728385],
      [50.52869439, 18.09729492], [50.5286888, 18.09730598], [50.52868321, 18.09731703],
      [50.52867761, 18.09732807], [50.528672, 18.0973391], [50.52866639, 18.09735012],
      [50.52866077, 18.09736113], [50.52865514, 18.09737214], [50.52864951, 18.09738313],
      [50.52864387, 18.09739412], [50.52863823, 18.0974051], [50.52863258, 18.09741607],
      [50.52862692, 18.09742703], [50.52862126, 18.09743798], [50.52861559, 18.09744892],
      [50.52860992, 18.09745985], [50.52860424, 18.09747077], [50.52859855, 18.09748169],
      [50.52859286, 18.09749259], [50.52858716, 18.09750349], [50.52858145, 18.09751438],
      [50.52857574, 18.09752526], [50.52857002, 18.09753613], [50.5285643, 18.09754699],
      [50.52855857, 18.09755784], [50.52855283, 18.09756869], [50.52854709, 18.09757952],
      [50.52854134, 18.09759035], [50.52853559, 18.09760117], [50.52852983, 18.09761198],
      [50.52852407, 18.09762278], [50.5285183, 18.09763358], [50.52851252, 18.09764436],
      [50.52850674, 18.09765514], [50.52850095, 18.09766591], [50.52849516, 18.09767667],
      [50.52848936, 18.09768742], [50.52848355, 18.09769817], [50.52847774, 18.0977089],
      [50.52847192, 18.09771963], [50.5284661, 18.09773035], [50.52846027, 18.09774106],
      [50.52845443, 18.09775176], [50.52844859, 18.09776246], [50.52844274, 18.09777314],
      [50.52843689, 18.09778382], [50.52843103, 18.09779449], [50.52842516, 18.09780515],
      [50.52841929, 18.0978158], [50.52841341, 18.09782645], [50.52840753, 18.09783708],
      [50.52840164, 18.09784771], [50.52839574, 18.09785833], [50.52838984, 18.09786894],
      [50.52838393, 18.09787954], [50.52837802, 18.09789014], [50.5283721, 18.09790072],
      [50.52836617, 18.0979113], [50.52836024, 18.09792187], [50.5283543, 18.09793243],
      [50.52834836, 18.09794298], [50.52834241, 18.09795352], [50.52833645, 18.09796406],
      [50.52833049, 18.09797459], [50.52832452, 18.09798511], [50.52831855, 18.09799562],
      [50.52831257, 18.09800612], [50.52830658, 18.09801662], [50.52830059, 18.0980271],
      [50.52829459, 18.09803758], [50.52828859, 18.09804805], [50.52828258, 18.09805851],
      [50.52827656, 18.09806896], [50.52827054, 18.09807941], [50.52826451, 18.09808985],
      [50.52825848, 18.09810028], [50.52825244, 18.0981107], [50.52824639, 18.09812111],
      [50.52824034, 18.09813152], [50.52823428, 18.09814191], [50.52822822, 18.0981523],
      [50.52822215, 18.09816268], [50.52821607, 18.09817305], [50.52820999, 18.09818342],
      [50.5282039, 18.09819377], [50.52819781, 18.09820412], [50.52819171, 18.09821446],
      [50.5281856, 18.09822479], [50.52817949, 18.09823511], [50.52817337, 18.09824543],
      [50.52816725, 18.09825574], [50.52816112, 18.09826604], [50.52815498, 18.09827633],
      [50.52814884, 18.09828661], [50.52814269, 18.09829689], [50.52813654, 18.09830715],
      [50.52813038, 18.09831741], [50.52812421, 18.09832766], [50.52811804, 18.0983379],
      [50.52811186, 18.09834814], [50.52810568, 18.09835836], [50.52809949, 18.09836858],
      [50.52809329, 18.09837879], [50.52808709, 18.09838899], [50.52808088, 18.09839918],
      [50.52807467, 18.09840936], [50.52806845, 18.09841954], [50.52806223, 18.0984297],
      [50.528056, 18.09843986], [50.52804976, 18.09845001], [50.52804352, 18.09846015],
      [50.52803727, 18.09847029], [50.52803102, 18.09848041], [50.52802476, 18.09849053],
      [50.52801849, 18.09850064], [50.52801222, 18.09851074], [50.52800594, 18.09852084],
      [50.52799966, 18.09853092], [50.52799337, 18.098541], [50.52798708, 18.09855107],
      [50.52798078, 18.09856113], [50.52797447, 18.09857118], [50.52796816, 18.09858123],
      [50.52796184, 18.09859126], [50.52795552, 18.09860129], [50.52794919, 18.09861131],
      [50.52794285, 18.09862132], [50.52793651, 18.09863132], [50.52793016, 18.09864132],
      [50.52792381, 18.0986513], [50.52791745, 18.09866128], [50.52791109, 18.09867125],
      [50.52790472, 18.09868121], [50.52789834, 18.09869116], [50.52789196, 18.09870111],
      [50.52788557, 18.09871104], [50.52787918, 18.09872097], [50.52787278, 18.09873089],
      [50.52786637, 18.0987408], [50.52785996, 18.0987507], [50.52785354, 18.0987606],
      [50.52784712, 18.09877048], [50.52784069, 18.09878036], [50.52783425, 18.09879023],
      [50.52782781, 18.09880009], [50.52782136, 18.09880994], [50.52781491, 18.09881978],
      [50.52780845, 18.09882962], [50.52780198, 18.09883945], [50.52779551, 18.09884927],
      [50.52778903, 18.09885908], [50.52778255, 18.09886888], [50.52777606, 18.09887867],
      [50.52776957, 18.09888845], [50.52776307, 18.09889823], [50.52775656, 18.098908],
      [50.52775005, 18.09891776], [50.52774353, 18.09892751], [50.527737, 18.09893725],
      [50.52773047, 18.09894699], [50.52772393, 18.09895672], [50.52771739, 18.09896644],
      [50.52771084, 18.09897615], [50.52770428, 18.09898585], [50.52769772, 18.09899555],
      [50.52769115, 18.09900523], [50.52768458, 18.09901491], [50.527678, 18.09902458],
      [50.52767141, 18.09903424], [50.52766482, 18.09904389], [50.52765822, 18.09905354],
      [50.52765161, 18.09906317], [50.527645, 18.0990728], [50.52763838, 18.09908242],
      [50.52763176, 18.09909203], [50.52762513, 18.09910163], [50.52761849, 18.09911122],
      [50.52761185, 18.09912081], [50.5276052, 18.09913038], [50.52759855, 18.09913995],
      [50.52759189, 18.09914951], [50.52758522, 18.09915906], [50.52757855, 18.0991686],
      [50.52757187, 18.09917814], [50.52756518, 18.09918766], [50.52755849, 18.09919718],
      [50.52755179, 18.09920669], [50.52754509, 18.09921619], [50.52753838, 18.09922568],
      [50.52753166, 18.09923516], [50.52752494, 18.09924464], [50.52751821, 18.0992541],
      [50.52751148, 18.09926356], [50.52750474, 18.09927301], [50.52749799, 18.09928245],
      [50.52749124, 18.09929188], [50.52748448, 18.0993013], [50.52747771, 18.09931072],
      [50.52747094, 18.09932013], [50.52746416, 18.09932953], [50.52745738, 18.09933892],
      [50.52745059, 18.0993483], [50.52744379, 18.09935767], [50.52743699, 18.09936703],
      [50.52743018, 18.09937639], [50.52742337, 18.09938573], [50.52741655, 18.09939507],
      [50.52740972, 18.0994044], [50.52740289, 18.09941372], [50.52739605, 18.09942303],
      [50.5273892, 18.09943234], [50.52738235, 18.09944163], [50.52737549, 18.09945092],
      [50.52736863, 18.0994602], [50.52736176, 18.09946947], [50.52735488, 18.09947873],
      [50.527348, 18.09948798], [50.52734111, 18.09949722], [50.52733421, 18.09950646],
      [50.52732731, 18.09951568], [50.5273204, 18.0995249], [50.52731349, 18.09953411],
      [50.52730657, 18.09954331], [50.52729964, 18.0995525], [50.52729271, 18.09956168],
      [50.52728577, 18.09957085], [50.52727882, 18.09958002], [50.52727187, 18.09958917],
      [50.52726491, 18.09959832], [50.52725795, 18.09960746], [50.52725098, 18.09961659],
      [50.527244, 18.09962571], [50.52723702, 18.09963482], [50.52723003, 18.09964393],
      [50.52722304, 18.09965302], [50.52721604, 18.09966211], [50.52720903, 18.09967119],
      [50.52720202, 18.09968026], [50.527195, 18.09968932], [50.52718798, 18.09969837],
      [50.52718095, 18.09970741], [50.52717391, 18.09971645], [50.52716687, 18.09972547],
      [50.52715982, 18.09973449], [50.52715276, 18.0997435], [50.5271457, 18.0997525],
      [50.52713863, 18.09976149], [50.52713156, 18.09977047], [50.52712448, 18.09977944],
      [50.52711739, 18.09978841], [50.5271103, 18.09979736], [50.5271032, 18.09980631],
      [50.52709609, 18.09981525], [50.52708898, 18.09982418], [50.52708186, 18.0998331],
      [50.52707474, 18.09984201], [50.52706761, 18.09985091], [50.52706047, 18.09985981],
      [50.52705333, 18.09986869], [50.52704618, 18.09987757], [50.52703903, 18.09988644],
      [50.52703187, 18.0998953], [50.5270247, 18.09990415], [50.52701753, 18.09991299],
      [50.52701035, 18.09992182], [50.52700317, 18.09993064], [50.52699598, 18.09993946],
      [50.52698878, 18.09994826], [50.52698158, 18.09995706], [50.52697437, 18.09996585],
      [50.52696716, 18.09997463], [50.52695994, 18.0999834], [50.52695271, 18.09999216],
      [50.52694548, 18.10000091], [50.52693824, 18.10000966], [50.526931, 18.10001839],
      [50.52692375, 18.10002712], [50.52691649, 18.10003584], [50.52690923, 18.10004455],
      [50.52690196, 18.10005325], [50.52689468, 18.10006194], [50.5268874, 18.10007062],
      [50.52688011, 18.1000793], [50.52687282, 18.10008796], [50.52686552, 18.10009662],
      [50.52685821, 18.10010527], [50.5268509, 18.10011391], [50.52684358, 18.10012254],
      [50.52683626, 18.10013116], [50.52682893, 18.10013977], [50.52682159, 18.10014838],
      [50.52681425, 18.10015697], [50.5268069, 18.10016556], [50.52679954, 18.10017414],
      [50.52679218, 18.10018271], [50.52678481, 18.10019127], [50.52677744, 18.10019982],
      [50.52677006, 18.10020836], [50.52676267, 18.10021689], [50.52675528, 18.10022542],
      [50.52674788, 18.10023394], [50.52674047, 18.10024245], [50.52673306, 18.10025095],
      [50.52672564, 18.10025944], [50.52671822, 18.10026792], [50.52671079, 18.1002764],
      [50.52670335, 18.10028486], [50.52669591, 18.10029332], [50.52668846, 18.10030177],
      [50.526681, 18.10031021], [50.52667354, 18.10031864], [50.52666607, 18.10032706],
      [50.5266586, 18.10033548], [50.52665112, 18.10034388], [50.52664363, 18.10035228],
      [50.52663614, 18.10036067], [50.52662864, 18.10036905], [50.52662114, 18.10037742],
      [50.52661363, 18.10038578], [50.52660611, 18.10039413], [50.52659859, 18.10040248],
      [50.52659106, 18.10041081], [50.52658353, 18.10041914], [50.52657599, 18.10042746],
      [50.52656844, 18.10043577], [50.52656089, 18.10044407], [50.52655333, 18.10045237],
      [50.52654577, 18.10046065], [50.5265382, 18.10046893], [50.52653062, 18.1004772],
      [50.52652304, 18.10048546], [50.52651545, 18.10049371], [50.52650786, 18.10050195],
      [50.52650026, 18.10051019], [50.52649265, 18.10051841], [50.52648504, 18.10052663],
      [50.52647742, 18.10053484], [50.5264698, 18.10054304], [50.52646217, 18.10055123],
      [
